# fx-syncstorage

![Version: 0.1.9](https://img.shields.io/badge/Version-0.1.9-informational?style=flat-square) ![Type: application](https://img.shields.io/badge/Type-application-informational?style=flat-square) ![AppVersion: syncstorage-rs-mysql-0.18.2](https://img.shields.io/badge/AppVersion-syncstorage--rs--mysql--0.18.2-informational?style=flat-square)

Helm chart for Mozilla's Rust based Sync server for Firefox data synchronization.

## Maintainers

| Name | Email | Url |
| ---- | ------ | --- |
| holysoles |  | <https://github.com/holysoles> |

## Requirements

| Repository | Name | Version |
|------------|------|---------|
| oci://registry-1.docker.io/bitnamicharts | syncserverdb(mysql) | 12.3.1 |
| oci://registry-1.docker.io/bitnamicharts | tokenserverdb(mysql) | 12.3.1 |

## Values

| Key | Type | Default | Description |
|-----|------|---------|-------------|
| affinity | object | `{}` | affinity for the syncstorage Deployment. |
| fullnameOverride | string | `""` |  |
| image.pullPolicy | string | `"IfNotPresent"` |  |
| image.repository | string | `"ghcr.io/porelli/firefox-sync"` |  |
| image.tag | string | `""` |  |
| imagePullSecrets | list | `[]` |  |
| ingress.annotations | object | `{}` |  |
| ingress.className | string | `""` |  |
| ingress.enabled | bool | `false` | deploy an ingress as part of the chart |
| ingress.hosts[0].host | string | `"fx-syncstorage.local"` |  |
| ingress.hosts[0].paths[0].path | string | `"/"` |  |
| ingress.hosts[0].paths[0].pathType | string | `"ImplementationSpecific"` |  |
| ingress.tls | list | `[]` |  |
| livenessProbe.httpGet.path | string | `"/__heartbeat__"` |  |
| livenessProbe.httpGet.port | int | `8000` |  |
| nameOverride | string | `""` |  |
| nodeSelector | object | `{}` | node selector to apply to the syncstorage Deployment. |
| podAnnotations | object | `{}` |  |
| podLabels | object | `{}` |  |
| podSecurityContext | object | `{}` |  |
| readinessProbe.httpGet.path | string | `"/__heartbeat__"` |  |
| readinessProbe.httpGet.port | int | `8000` |  |
| replicaCount | int | `1` |  |
| resources | object | `{}` |  |
| securityContext | object | `{}` |  |
| service.port | int | `80` | Port for the service to listen on. |
| service.type | string | `"ClusterIP"` | Service type for the syncstorage service. |
| serviceAccount.annotations | object | `{}` |  |
| serviceAccount.name | string | `""` |  |
| syncserverdb.architecture | string | `"standalone"` |  |
| syncserverdb.auth.database | string | `"syncstorage"` |  |
| syncserverdb.auth.existingSecret | string | `"autogenerated-fx-syncserverdb"` | Specify an existing secret for credentials. The default will auto-generate credentials. |
| syncserverdb.auth.username | string | `"syncuser"` |  |
| syncserverdb.enabled | bool | `true` | Enable the bundled [mysql subchart from bitnami](https://github.com/bitnami/charts/tree/main/bitnami/mysql) for the sync server DB. |
| syncserverdb.extraFlags | list | `["--explicit_defaults_for_timestamp"]` | MySQL secondary additional command line flags |
| syncserverdb.primary.persistence.enabled | bool | `true` |  |
| syncserverdb.primary.persistence.size | string | `"4Gi"` |  |
| syncserverdb.primary.persistence.storageClass | string | `""` |  |
| syncstorage.domain | string | `""` | The URL at which the storagesync server will be available. Must be set. |
| syncstorage.host | string | `"0.0.0.0"` | IP to listen on. |
| syncstorage.humanLogs | int | `1` | Whether or not to log in a human readable format |
| syncstorage.keepGeneratedSecrets | bool | `false` | Whether or not to persist generated secret objects even after a helm uninstall. |
| syncstorage.masterSecret | string | `""` | A master secret can be specified here. If empty, one will be autogenerated. |
| syncstorage.maxUsers | int | `1` | The maximum amount of users that are allowed to store data on the server. |
| syncstorage.rustLogLevel | string | `"info"` | Rust log level |
| syncstorage.syncserver.databaseUrl | string | `""` | URL for connecting to the syncserver DB. If empty, will be autogenerated based on the bundled mysql instance. |
| syncstorage.tokenserver.additionalBlockingThreadsForFxaRequests | int | `2` |  |
| syncstorage.tokenserver.databaseUrl | string | `""` | URL for connecting to the tokenserver DB. If empty, will be autogenerated based on the bundled mysql instance. |
| syncstorage.tokenserver.fxaEmailDomain | string | `"api.accounts.firefox.com"` | Auth Provider Domain |
| syncstorage.tokenserver.fxaMetricsHashSecret | string | `""` | A secret for hashing metrics for Sentry can be specified here. If empty, one will be autogenerated. Sentry should be automatically disabled on self-hosted instances. |
| syncstorage.tokenserver.fxaOauthServerUrl | string | `"https://oauth.accounts.firefox.com/v1"` | OAuth Provider URL |
| syncstorage.tokenserver.nodeType | string | `"mysql"` | The database node type. |
| syncstorage.tokenserver.runMigrations | bool | `true` | Whether or not to run db migration tasks on startup. |
| tokenserverdb.architecture | string | `"standalone"` |  |
| tokenserverdb.auth.database | string | `"tokenserver"` |  |
| tokenserverdb.auth.existingSecret | string | `"autogenerated-fx-tokenserverdb"` | Specify an existing secret for credentials. The default will auto-generate credentials. |
| tokenserverdb.auth.username | string | `"tokenuser"` |  |
| tokenserverdb.enabled | bool | `true` | Enable the bundled [mysql subchart from bitnami](https://github.com/bitnami/charts/tree/main/bitnami/mysql) for the token server DB. |
| tokenserverdb.extraFlags | list | `["--explicit_defaults_for_timestamp"]` | MySQL secondary additional command line flags |
| tokenserverdb.primary.persistence.enabled | bool | `true` |  |
| tokenserverdb.primary.persistence.size | string | `"4Gi"` |  |
| tokenserverdb.primary.persistence.storageClass | string | `""` |  |
| tolerations | list | `[]` | tolerations to apply to the syncstorage Deployment. |
| volumeMounts | list | `[]` | Additional volumeMounts on the syncstorage Deployment. |
| volumes | list | `[]` | Additional volumes on the syncstorage Deployment. |

